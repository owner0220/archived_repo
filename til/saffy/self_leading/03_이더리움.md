# 이더리움

### 개요

- Homestead 버전
- 17.10월 이후 Metropolis(Byzantinm)
- 비트 코인과 비슷 작업증명(Ethash) 기반 현재 채굴 합의 알고리즘이 소유 증명 기반으로 변경 예정



### 스마트 계약

- 외부 참여자에 의한 작성 블록체인에 저장된 실행가능 프로그램 (ex 에스크로)



#### 스마트 계약 작성 언어

- 이더리움 스마트 계약 전용 튜링 완전한 언어
  - 모든 이더리움 풀노드는 동일한 EVM 실행 환경 제공

#### 종류

- Solidity
- Serpent
- LLL



### 이더리움 거래 참여자

- 외부참여자 : 블록체인 계좌 가진 사람 또는 외부 서버 (지불거래)
- 내부참여자 : 블록체인에 존재하는 프로그램 (스마트 계약)
- 외부 참여자와 내부 참여자 간 거래 : 스마트 계약 실행거래



### 비트 코인과 이더리움의 큰 차이

- 비트코인 : 주소기반 거래
- 이더리움 : 계좌기반 거래 (송신, 수신 계좌로 관리)



#### 외부 소유 계좌(EOA-Externally Owned Account)

- 외부 참여자가 자신의 개인키를 소유하는 계좌

#### 계약 계좌

- 블록체인에 존재하는 스마트 계약 코드에 의해 제어되는 계좌



#### 계좌구조

- 넌스(nonce) ; 중복 거래 방지를 위한 데이터
  - Replay Attack : 같은 돈을 이용한 다른 거래 공격
- 잔고(balance)
- 저장소루트(storage Root)
- 코드해시(code hash)



#### EOA

- keccak256 : HSA256 이후 표준 HSA3 만들기 위해 제안된 해시 알고리즘



#### 가스 공급 기반 거래 실행

- 거래 실행 시 실행에 요구되는 명령 종류, 수에 상응하는 비용 지불
- 자체 통화인 이더(ETH) 기반의 가스 공급, 메커니즘을 거래 실행에 도입
- GasLimit을 두어서 무한 Loop 공격을 막았다.
  - 비트코인은 튜링 불완전 언어였는데 그 큰 이유중 하나가 loop를 통한 공격을 방지하기 위함이었다.



#### 이더리움 거래 스마트 계약

##### 거래 자료구조

- 넌스 (nonce)
- 가스가격 (gasPrice)
- 가스한도 (gasLimit)
- 수신자 (to)
- 값 (value)
- v, r, s (공개키와 주소 복구가 가능한 정보)
- 시작코드 (init)
- 데이터 (data)



#### 작업 증명 프로토콜

##### GHOST(Greedy Heaviest Observed Subtree) 프로토콜

- 비트코인 : 최장길이 체인을 메인 체인으로 선택
- 이더리움 : 가장 무거운 서브트리의 최장 길이 체인을 메인 체인으로 선택



##### 블록 인센티브

- 블록 보상 5ETH로 고정 2017.10 부터 3ETH 지급으로 변경
- 더이상 블록이 생산되지 않을때 작업증명에서 소유증명으로 변환될 것이다.
  - 삼촌블럭
  - 조카블럭

##### 비트코인 해시 해쉬 알고리즘

- 고정 크기 블록 헤더에 넌스를 변경해서 해시 함수 반복 적용
- ASIC 화 용이 : 비교적 적은 투자로 해시파워 집중화 가능



##### ETHash 해싱 알고리즘

- DAG 데이터 생성
  - 데이터 셋에 빨리 접속할 수 있을 때 채굴이 잘 된다.
  - GPU 이용량 증가