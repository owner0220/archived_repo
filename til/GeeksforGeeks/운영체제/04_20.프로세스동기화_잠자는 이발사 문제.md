- 학습을 위해 글을 올립니다.
- 모든 출처와 저작권은 Geeksforgeeks에 있습니다.

[^출처]: https://www.geeksforgeeks.org/



# 프로세스 동기화_잠자는 이발사 문제

##### 문제

- 하나의 이발사가 있는 가상의 이발소를 가정한다.
- 이발사가 앉을 의자, 고객이 기다릴 의자
  - 고객이 없다면 이발사는 자기 의자에서 잔다.
  - 고객이 도착하면 이발사를 깨워야 한다.
  - 고객이 많고 이발사가 고객의 머리카락을 자르고 있는 경우 나머지 고객은 대기실에 빈 의자가 있을 때까지 기다리거나 의자가 비어있지 않으면 떠난다.

![img](https://cdncontribute.geeksforgeeks.org/wp-content/uploads/Untitled-Diagram-25.png)

##### 해결책

- 세개의 세마포어를 사용해 문제를 해결한다.
  - 우선 대기실에 있는 고객 수
  - 이발사가 일을 하는지 않하는지 나타내는 수
  - 뮤텍스는 프로세스 실행에 필요한 상호 제외를 제공하는데 사용된다.
- 고객은 대기실에서 기다리는 고객의 수를 기록한다. 고객 수가 대기실의 의자 수와 같으면 다가오는 고객은 이발소를 떠난다.
- 아침에 이발사가 나타나면 프로 시저 이발사를 실행해 처음에은 0이기 때문에 세마포어 고객을 차단한다. 그러면 이발사는 첫 고객이 올 때까지 잠자기 상태가 된다.
- 고객이 도착하면 고객이 고객이 임계 지역에 진입하기 위한 뮤텍스를 얻는 고객 절차를 실행한다. 다른 고객이 진입한 후에는 첫 번째 고객이 뮤텍스를 반환 할 때까지 아무것도 할 수 없다. 고객은 기다리는 고객이 의자 수보다 적으면 대기실의 의자를 확인한 다음 다른 사람이 앉으면 뮤텍스를 반환 후 떠난다.
- 의자가 사용가능하면 고객은 대기실에 앉아 변수 대기 값을 증가시키고 고객의 세마포어를 늘리면 자고있는 경우 이발사가 깨어난다.

![img](https://cdncontribute.geeksforgeeks.org/wp-content/uploads/abc-3.png)