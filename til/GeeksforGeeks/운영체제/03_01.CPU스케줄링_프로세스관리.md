- 학습을 위해 글을 올립니다.
- 모든 출처와 저작권은 Geeksforgeeks에 있습니다.

[^출처]: https://www.geeksforgeeks.org/



# CPU스케줄링_프로세스관리

- 프로세스는 실행중인 프로그램이다. 예를 들어 C언어로 프로그램을 작성하고 컴파일하면 컴파일러는 2진 코드를 작성한다.
- 원래 코드와 바이너리 코드는 두 프로그램이다. 실제로 바이너리 코드를 실행하면 프로세스가 된다.

![](https://www.geeksforgeeks.org/wp-content/uploads/gq/2015/06/process.png)

##### 텍스트 섹션

- 프로세스(텍스트 섹션이라고도 한다.) 프로그램 카운터의 값으로 표시되는 현재 활동도 포함된다.

##### 스택

- 스택에는 함수 매개 변수, 반환 주소 및 로컬 변수와 같은 임시 데이터가 포함된다.

##### 데이터 섹션

- 전역 변수를 포함합니다.

##### 힙 섹션

- 런타임 중에 처리할 동적으로 할당 된 메모리



## C프로그램의 메모리 레이아웃

1. 텍스트 세그먼트
2. 초기화 된 데이터 세그먼트
3. 초기화되지 않은 데이터 세그먼트
4. 스택
5. 힙

![img](https://cdncontribute.geeksforgeeks.org/wp-content/uploads/memoryLayoutC.jpg)

#### 텍스트 세그먼트(Text Segment)

- 코드 세그먼트 또는 단순히 텍스트로 알려진 텍스트 세그먼트는 객체 파일이나 메모리의 프로그램 섹션 중 하나이며, 실행 가능한 명령어가 들어가 있다.(읽기 전용)

#### 초기화 된 데이터 세그먼트

- 일반적으로 데이터 세그먼트는 프로그래머가 초기화 한 **전역 변수**와 **정적 변수를 포함**하는 프로그램의 가상 주소 공간 부분이다.
- 변수의 값은 런타임에 변경 될 수 있기때문에 데이터 세그먼트는 읽기 전용이 아니다.
- 초기화된 읽기 전용 영역 + 초기화 된 읽기/쓰기 영역 으로 분류 할 수 있다.
  - 예시
    - 전역 문자 -> 초기화된 읽기 / 쓰기 영역에 저장
    - const char* string = "helloworld"    (전역 C 명령문은 문자열 리터럴을 초기화된 읽기 전용 영역에 저장, 문자 포인터 변수 문자열을 초기화 된 읽기/쓰기 영역에 저장한다.)
    - static int i = 10 , global int i = 10 둘다 정적 데이터 세그먼트에 저장

#### 초기화되지 않은 데이터 세그먼트

- 초기화되지 않은 데이터는 데이터 세그먼트의 끝에서 시작되며 0으로 초기화되거나 소스코드에서 명시 적으로 초기화 되지 않은 모든 전역 변수와 정적 변수를 포함한다.
- **BSS**(Block Started by Symbol)
  - 예시
    - static int i;
    - global int j;

#### 스택

- 힙 영역에 인접해 반대 방향으로 커진다. 스택 포인터가 힙 포인터를 만났을 때 사용 가능한 메모리를 다 쓴 것이다. 스택 영역에는 일반적으로 메모리 상위 부분에 위치한 LIFO 구조의 프로그램 스택이 포함된다.

#### 힙

- 힙은 일반적으로 동적 메모리 할당이 이뤄지는 부분이다.
- BSS(Block Started by Symbol) 세그먼트의 끝에서 시작해 더 큰 주소로 커진다.
- malloc, realloc 및 free로 관리 되며 brk 및 sbrk 시스템 호출을 사용해 크기를 조정할 수 있다.
- 힙 역역은 프로세스의 모든 공유 라이브러리와 동적으로 로드 된 모듈로 공유된다.

### 프로세스

- 프로세스 ID : 운영체제에 의해 할당 된 고유한 식별자
- 프로세스 상태
- CPU 레지스터 : 프로그램 카운터와 같다.(CPU 레지스터를 저장해야 하며 프로세스가 CPU에서 스왑 인/ 스왑 될 때 복원 된다.)
- 계정 정보
- I / O 상태 정보 : 예를 들면 프로세스에 할당 된 장치, 파일 열기 등
- CPU 예약 정보 : 예를 들어 우선순위(다른 프로세스 예를 들어 다른 우선 순위를 가질 수 있다. 짧은 프로세스에는 낮은 우선 순위가 할당 될 수 있다. 가장 짧은 일자리에서 첫 번째 스케줄링)

※ 위 속성은 모두 프로세스 **컨텍스트**라고도 한다.

모든 프로세스에는 자체 프로그램 제어 블록(PCB)이 있다. 즉, 프로세스 마다 고유한 PCB가 있는데 위의 모든 속성은 PCB의 일부이다.



#### 프로세스 상태

1. 신규
2. 준비
3. 실행
4. 대기(또는 차단)
5. 완료(또는 종결)
6. 일시 중단 준비
7. 일시 중지 된 블록

![](https://www.geeksforgeeks.org/wp-content/uploads/gq/2015/06/process-states1.png)

#### 컨텍스트 스위칭

- 한 프로세스의 컨텍스트를 저장하고 다른 프로세스의 컨텍스트를 로드하는 프로세스를 컨텍스트 스위칭이라고 한다. 간단히 말해 프로세스를 실행 상태에서 준비 상태로 로드 및 언로드 하는 것과 같다.
  - 우선 순위가 높은 프로세스가 준비 상태가 될때(실행 중인 프로세스 보다 우선 순위가 높을 때)
  - 인터럽트가 발생했을 때
  - 사용자 및 커널 모드 스위치(반드시 발생하는 것은 아니다.)
  - 선점 형 CPU 스케줄링 사용된다.



#### 컨텍스트 스위치 대 모드 스위치

- 모든 권한은 CPU 권한 수준이 변경 될 때 발생한다. 예를 들어 시스템 호출이 발생하거나 오류가 발생한 경우
- 커널은 표준 사용자 작업보다 권한 모드에서 작동한다.
- 사용자 프로세스가 커널에서만 액세스 할 수 있는 것에 액세스 하려면 모드 전환이 발생해야 한다.

